/*!
 * SVG path parser
 * version: 2019.09.03
 * author: dobrapyra
 * url: https://github.com/dobrapyra/SvgPathParser
 */
Object.keys||(Object.keys=function(a){if(a!==Object(a))throw new TypeError("Object.keys called on a non-object");var r,s=[];for(r in a)a.hasOwnProperty(r)&&s.push(r);return s}),Object.assign||(Object.assign=function(a){if(a!==Object(a))throw new TypeError("Object.assign called on a non-object");var r,s,e,c,t,n,m,p;for(r=Object(a),t=arguments.length,c=1;c<t;c++)if(s=arguments[c])for(m=(e=Object.keys(s)).length,n=0;n<m;n++)r[p=e[n]]=s[p];return r});var SvgPathParser=function(a){this.init(a)};Object.assign(SvgPathParser.prototype,{init:function(a){this.precision=a.precision||1e5,this.outputMode=a.outputMode||"array"},parsePath:function(a){return a.tagName&&"path"!==!a.tagName?this.parse(a.getAttribute("d")):(console.warn("Wrong input, expected path element."),this.subPathsArr=[],this)},parse:function(a){var r=this._getCmdGroupArr(a),s=this._getCmdArr(r),e=this._getCmdBeginEndXY(s);return this.cmdArr=e,this.subPathsArr=this._getXYArr(e),this},_getCmdGroupArr:function(a){return a.replace(/\s*\,\s*/g," ").replace(/\s*\-\s*/g," -").replace(/m|l|h|v|z|c|s|q|t|a/gi,function(a){return"|"+a}).split(/\s*\|\s*/).filter(function(a){return""!==a}).map(function(a){return{cmd:a.slice(0,1),params:a.slice(1).split(/\s*\ \s*/).filter(function(a){return""!==a}).map(function(a){return parseFloat(a)})}})},_getCmdArr:function(a){var r,s,e=[];return a.map(function(a){switch(r=a.params.length,s=0,a.cmd){default:console.warn("Unexpected command "+a.cmd);break;case"m":case"l":for(e.push({cmd:a.cmd,params:a.params.slice(s,s+2)}),s+=2;s<r;)e.push({cmd:"l",params:a.params.slice(s,s+2)}),s+=2;break;case"M":case"L":for(e.push({cmd:a.cmd,params:a.params.slice(s,s+2)}),s+=2;s<r;)e.push({cmd:"L",params:a.params.slice(s,s+2)}),s+=2;break;case"h":case"v":case"H":case"V":for(;s<r;)e.push({cmd:a.cmd,params:a.params.slice(s,s+1)}),s+=1;break;case"z":for(e.push({cmd:a.cmd,params:[]});s<r;)e.push({cmd:"l",params:a.params.slice(s,s+2)}),s+=2;break;case"Z":for(e.push({cmd:a.cmd,params:[]});s<r;)e.push({cmd:"L",params:a.params.slice(s,s+2)}),s+=2;break;case"c":case"C":for(;s<r;)e.push({cmd:a.cmd,params:a.params.slice(s,s+6)}),s+=6;break;case"s":case"S":case"q":case"Q":for(;s<r;)e.push({cmd:a.cmd,params:a.params.slice(s,s+4)}),s+=4;break;case"t":case"T":for(;s<r;)e.push({cmd:a.cmd,params:a.params.slice(s,s+2)}),s+=2;break;case"a":case"A":for(;s<r;)e.push({cmd:a.cmd,params:a.params.slice(s,s+7)}),s+=7}return a}),e},_getCmdBeginEndXY:function(a){var r,s,e=this._roundVal,c=this.precision,t=null,n=[0,0],m=[0,0];return a.map(function(a){switch(r=[m[0],m[1]],a.cmd){default:console.warn("Unexpected command "+a.cmd);break;case"m":s=[e(r[0]+a.params[0],c),e(r[1]+a.params[1],c)],"z"!==t&&"Z"!==t&&"m"!==t&&"M"!==t&&null!==t||(n=s);break;case"M":s=[a.params[0],a.params[1]],"Z"!==t&&"z"!==t&&"M"!==t&&"m"!==t&&null!==t||(n=s);break;case"l":s=[e(r[0]+a.params[0],c),e(r[1]+a.params[1],c)];break;case"L":s=[a.params[0],a.params[1]];break;case"h":s=[e(r[0]+a.params[0],c),r[1]];break;case"H":s=[a.params[0],r[1]];break;case"v":s=[r[0],e(r[1]+a.params[0],c)];break;case"V":s=[r[0],a.params[0]];break;case"z":case"Z":s=[n[0],n[1]];break;case"c":s=[e(r[0]+a.params[4],c),e(r[1]+a.params[5],c)];break;case"C":s=[a.params[4],a.params[5]];break;case"s":s=[e(r[0]+a.params[2],c),e(r[1]+a.params[3],c)];break;case"S":s=[a.params[2],a.params[3]];break;case"q":s=[e(r[0]+a.params[2],c),e(r[1]+a.params[3],c)];break;case"Q":s=[a.params[2],a.params[3]];break;case"q":s=[e(r[0]+a.params[0],c),e(r[1]+a.params[1],c)];break;case"Q":s=[a.params[0],a.params[1]];break;case"a":s=[e(r[0]+a.params[5],c),e(r[1]+a.params[6],c)];break;case"A":s=[a.params[5],a.params[6]]}return t=a.cmd,m=s,Object.assign(a,{xy:{begin:r,end:s}})})},_getXYArr:function(a){var r=[],s=0,e=a.length-1,c=0,t=null;return r[s]=[],a.map(function(a){if("m"!==a.cmd&&("M"!==a.cmd||"m"!==t&&"M"!==t&&"z"!==t&&"Z"!==t)||r[s].splice(-1),"z"===a.cmd||"Z"===a.cmd){if(c===e)return a;r[++s]=[]}return r[s].push(a.xy.end),c++,t=a.cmd,a}),r},result:function(a,r){var s=this._roundArr.bind(this),e=this._formatArr.bind(this),c=r||this.outputMode,t=a||this.precision,n=[],m=this.subPathsArr.map(function(a){var r=e(s(a,t),c);return n=n.concat(r),r});return{commands:this.cmdArr,points:m,allPoints:n}},_roundArr:function(a,r){var s=this._roundVal;return a.map(function(a){return[s(a[0],r),s(a[1],r)]})},_roundVal:function(a,r){return Math.round(a*r)/r},_formatArr:function(a,r){return"object"!==r?a:a.map(function(a){return Object.assign({},{x:a[0],y:a[1]})})}});